# 游标

## 创建游标

``` SQL
-- 游标仅局限于储存过程内，储存过程结束游标就消失了
CREATE PROCEDURE Func()
BEGIN
    DECLARE Value Type DEFAULT Val;
    DECLARE Cursor CURSOR FOR
        SELECT Column FROM Table;
    OPEN Cursor;
    FETCH Cursor INTO Value;
    SELECT Value;
    CLOSE Cursor;
END;
```

## 开关游标

``` SQL
OPEN Cursor;
CLOSE Cursor;
```

## 释放游标

``` SQL
-- 释放游标
DEALLOCATE Cursor;
```

## 使用游标数据

``` SQL
-- 遍历
DELIMITER \\

CREATE PROCEDURE Procedure()
BEGIN
    DECLARE Value Type DEFAULT Val;
    DECLARE Done BOOLEAN DEFAULT FALSE;
    DECLARE Cursor CURSOR FOR
        SELECT Column FROM Table;
    -- 若遍历结束则将Done置为TRUE
    DECLARE CONTINUE HANDLER for not FOUND set Done = TRUE;

    OPEN Cursor;
    Label : LOOP
        IF Done THEN
            LEAVE Label;
        END IF;
        FETCH Cursor INTO Value;
        SELECT Value;
    END LOOP Label;
    CLOSE Cursor;
END\\
```
